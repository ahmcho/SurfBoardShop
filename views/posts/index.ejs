<% layout('layouts/post-index') -%>
<div class="container-fluid p-5">
	<div class="row">
		<div class="col-md-12">
			<h1>Search for locations</h1>
		</div>
		<div class="col-6">
			<% include ../partials/searchFilter %>
		</div>
		<div class="col-6">
			<div id="map"></div>
		</div>
	</div>

	<% include ../partials/paginatePosts %>

	<% posts.docs.forEach(function(post) { %>
		<div>
			<h2><%= post.title %></h2>
			<div><strong>Price</strong>: <%= post.price %>$</div>
			<div><%= post.description %></div>
			<div><strong>Location</strong>: <%= post.location %></div>
			<div><a href="/posts/<%= post.id %>">View more</a></div>
		</div>
	<% }); %>

	<% include ../partials/paginatePosts %>
</div> <!-- container fluid -->
<script>
	mapboxgl.accessToken = "<%= mapBoxToken %>";
	var posts = { features: <%- JSON.stringify(posts.docs) %> };
</script>
<script src="/javascripts/allPostsClusterMap.js"></script>